{% extends 'IndicadorBundle::baseindic.html.twig' %} 
{% block content %}        
        <h3>Historial de AT por Patrimonio</h3>
	{{ form_start(form)}} 
            {{ form_row(form.fechadesde) }}
            {{ form_row(form.fechahasta) }}
            <div class="row">
		<div class="col-xs-8">
                {{ form_row(form.patrimonio) }}	
		</div>
                <div class="col-xs-4">
                    <div class="form-group">
			<label>&nbsp;</label>
                        <div> 
                            <a href="{{ path('patrimonio_existe') }}" id="consulta" class="btn btn-primary">
                                Consultar
                            </a>
                        </div>
                    </div>					
		</div>
            </div>
            <p id="descripcion"> &nbsp; </p>
	{{ form_end(form) }}
        <br/>
        <table class="table table-bordered table-striped ">
            <thead>
                <th>Nro. Patrimonio</th>
                <th>Nombre</th>
                <th>Nro. AT</th>
                <th>Fecha de Solicitud</th>
            </thead>
            <tbody>
                {% for dato in entities.datos%}
                <tr>
                    <td>{{ dato.patNumero }}</td>
                    <td>{{ dato.patNombre }}</td>
                    <td>{{ dato.atNumero }}</td>
                    <td>{{ dato.atFecha | date('d/m/Y - H:i:s') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>    
{% endblock %}
{% block javascript %}
	<script type="text/javascript">
            $(document).ready(function(){
		$('#consulta').on('click',
            function(){ 
                    $.ajax({
			                 url: $(this).attr('href')+"/"+$('#atmanager_indicadorbundle_indicador_patrimonio').val(),
			                     dataType: "json",
                            error: function(jqXHR,textstatus)
                            {
				                $('#descripcion').html('No existe patrimonio...');
				                //alert("No existe!!");
                            },
                            success: function(data, textstatus)
                            {
                                console.log(data);
				                $('#descripcion').html(data.descripcion);
                            }
                    });
		return false;
		});
            });
	</script>
{% endblock %}

